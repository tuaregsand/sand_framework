{
    "reentrancy": {
        "patterns": [
            {
                "pattern": "invoke_signed|invoke",
                "without": "require\\(!ctx\\.accounts\\.[a-zA-Z_]+\\.is_locked",
                "severity": "critical",
                "description": "Cross-Program Invocation without reentrancy protection",
                "cwe_id": "CWE-841",
                "recommendation": "Implement reentrancy guards using account locks"
            }
        ]
    },
    "access_control": {
        "patterns": [
            {
                "pattern": "pub fn",
                "without": "require\\(ctx\\.accounts\\.[a-zA-Z_]+\\.authority",
                "severity": "critical",
                "description": "Public function without proper authority validation",
                "cwe_id": "CWE-284",
                "recommendation": "Implement proper authority checks"
            }
        ]
    },
    "input_validation": {
        "patterns": [
            {
                "pattern": "#\\[account\\(",
                "without": "constraint =",
                "severity": "medium",
                "description": "Account struct without proper constraints",
                "cwe_id": "CWE-20",
                "recommendation": "Add appropriate constraints to account validation"
            }
        ]
    },
    "arithmetic": {
        "patterns": [
            {
                "pattern": "\\w+\\s*[\\+\\-\\*\\/]\\s*\\w+",
                "without": "checked_add|checked_sub|checked_mul|checked_div",
                "severity": "high",
                "description": "Unchecked arithmetic operation",
                "cwe_id": "CWE-190",
                "recommendation": "Use checked arithmetic operations"
            }
        ]
    },
    "pda_validation": {
        "patterns": [
            {
                "pattern": "seeds = \\[",
                "without": "require_keys_eq!",
                "severity": "high",
                "description": "PDA seeds specified without address validation",
                "cwe_id": "CWE-287",
                "recommendation": "Validate PDA addresses using require_keys_eq!"
            }
        ]
    },
    "error_handling": {
        "patterns": [
            {
                "pattern": "invoke",
                "without": "catch|map_err",
                "severity": "medium",
                "description": "CPI call without proper error handling",
                "cwe_id": "CWE-755",
                "recommendation": "Implement proper error handling for CPI calls"
            }
        ]
    },
    "cryptographic": {
        "patterns": [
            {
                "pattern": "Pubkey::find_program_address",
                "without": "bump",
                "severity": "high",
                "description": "PDA derivation without bump seed handling",
                "cwe_id": "CWE-326",
                "recommendation": "Always handle bump seeds in PDA derivation"
            }
        ]
    }
}
